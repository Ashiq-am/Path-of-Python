# Use take_along_axis to select the elements
result_arr = np.take_along_axis(val_arr, z_indices_expanded, axis=0)
